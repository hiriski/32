"use strict";(self.webpackChunkquiz=self.webpackChunkquiz||[]).push([[845],{3845:function(e,n,i){i.r(n),i.d(n,{default:function(){return he}});var r,t,s,l,a,o,d,c,u,m,x,h,p,f,v=i(4165),g=i(5861),j=i(2791),Z=i(7689),b=i(7022),N=i(9743),y=i(2677),k=i(4270),C=i(9582),w=i(8815),I=i(2351),S=(i(7261),i(5305)),R=i(4420),_=i(7709),P=i(168),B=i(1413),F=i(9439),q=i(5630),M=i(3360),U=i(4812),A=i(1134),z=i(4695),O=i(8007),E=(i(561),i(1830)),T=i.n(E),L=i(9681),G=i(8520),V=(i(7992),i(6063)),D=(i(5218),i(8414)),W=i(61),Q=i(9346),X=i(184),H=W.ZP.div(r||(r=(0,P.Z)(["\n    display: flex;\n    align-items: center;\n    height: 72px;\n    width: 100%;\n    border: 1px solid rgb(109 109 109 / 10%);\n    border-radius: 0.4rem;\n    margin-bottom: 0.5rem;\n    padding: 0.2rem 0.6rem;\n    cursor: pointer;\n"]))),K=W.ZP.div(t||(t=(0,P.Z)(["\n    margin-left: 0.8rem;\n"]))),J=W.ZP.h4(s||(s=(0,P.Z)(["\n    font-size: 1rem;\n    font-weight: 700;\n    margin-bottom: 0.25rem;\n    margin-right: 1rem;\n"]))),Y=W.ZP.p(l||(l=(0,P.Z)(["\n    font-size: 0.8rem;\n    margin-bottom: 0;\n"]))),$=W.ZP.img(a||(a=(0,P.Z)(["\n    width: 45px;\n    height: 45px;\n    border-radius: 45px;\n"]))),ee=W.ZP.button(o||(o=(0,P.Z)(["\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin-left: auto;\n    height: 26px;\n    width: 26px;\n    background-color: transparent;\n    border: 1px solid #ececec;\n    border-radius: 26px;\n    padding: 0;\n    svg {\n        font-size: 26px;\n        color: #03a9f4;\n    }\n"]))),ne=function(e){var n=e.data,i=e.checked,r=e.onCheck,t=e.canChecked,s=(0,j.useCallback)((function(){t&&r(n)}),[n,r,t]);return(0,X.jsxs)(H,{onClick:s,children:[(0,X.jsx)($,{src:(null===n||void 0===n?void 0:n.imgPath)||Q}),(0,X.jsxs)(K,{children:[(0,X.jsx)(J,{children:n.displayName}),(0,X.jsx)(Y,{children:n.email})]}),t&&(0,X.jsx)(ee,{onClick:s,children:i?(0,X.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,X.jsx)("path",{fill:"currentColor",d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10m-.997-6l7.07-7.071l-1.413-1.414l-5.657 5.657l-2.829-2.829l-1.414 1.414z"})}):(0,X.jsx)("div",{})})]})},ie=W.ZP.div(d||(d=(0,P.Z)(["\n    .modal-dialog {\n        width: 620px !important;\n    }\n"]))),re=W.ZP.div(c||(c=(0,P.Z)(["\n    background-color: #fff;\n    border-radius: 0.4rem;\n    padding: 1rem;\n"]))),te=W.ZP.div(u||(u=(0,P.Z)([""]))),se=function(e){var n=e.defaultValues,i=e.onSubmit,r=(0,R.I0)(),t=(0,I.zn)(),s=t.notifications_setOpenModalUserRecipients,l=t.openModalUserRecipients,a=t.notificationRecipientsData,o=(0,j.useState)(""),d=(0,F.Z)(o,2),c=d[0],u=d[1],m=(0,j.useState)(!1),x=(0,F.Z)(m,2),h=x[0],p=x[1],f=(0,j.useState)([]),v=(0,F.Z)(f,2),g=v[0],Z=v[1],b=(0,j.useCallback)((function(e){var n=Array.from(g);if(null===g||void 0===g?void 0:g.find((function(n){return n._id===(null===e||void 0===e?void 0:e._id)}))){var i=Array.from(g).filter((function(n){return n._id!==e._id}));Z(i)}else Z([].concat(n,[e]))}),[g]),k=(0,j.useMemo)((function(){if((null===a||void 0===a?void 0:a.length)>0)return(null===c||void 0===c?void 0:c.length)>0?a.filter((function(e){var n,i;return null===(n=e.displayName)||void 0===n||null===(i=n.toLowerCase())||void 0===i?void 0:i.includes(null===c||void 0===c?void 0:c.toLowerCase())})):a}),[c,a]),C=(0,j.useMemo)((function(){return(null===g||void 0===g?void 0:g.length)===a.length}),[g,a]),w=(0,j.useCallback)((function(){r(s(!1)),i(g)}),[g,h,l]),S=(0,j.useCallback)((function(e){u(e.target.value)}),[c]),_=(0,j.useCallback)((function(){i(g),w()}),[g,l]);(0,j.useEffect)((function(){(null===n||void 0===n?void 0:n.length)>0&&(Z(n),p(!1))}),[n,h]);var P=(0,j.useCallback)((function(){Z(C?[]:a)}),[C]);return(0,X.jsx)(ie,{children:(0,X.jsx)(U.KN,{className:"modal-notification-recipients",open:l,onClose:w,centered:!0,children:(0,X.jsxs)(re,{children:[(0,X.jsx)("div",{className:"mb-4",children:"Select notification recipients"}),(0,X.jsx)(te,{children:(0,X.jsx)(U.O1,{name:"searchValue",value:c,placeholder:"Search user",onChange:S,style:{marginBottom:"1rem"}})}),(0,X.jsxs)(N.Z,{className:"justify-content-center",children:[(0,X.jsx)(y.Z,{xs:12,className:"px-2 text-center mb-2",children:(null===k||void 0===k?void 0:k.length)>0&&(0,X.jsx)(M.Z,{size:"sm",onClick:P,children:C?"Unselect All":"Select All"})}),(0,X.jsx)(y.Z,{xs:12,className:"px-2",children:Array.isArray(k)&&k.length>0?(0,X.jsx)(j.Fragment,{children:k.map((function(e,n){return(0,X.jsx)(ne,{data:e,checked:g.find((function(n){return n._id===e._id})),onCheck:b,canChecked:!0},String(n))}))}):(0,X.jsx)("div",{className:"text-center py-4",children:(0,X.jsx)("p",{children:"Users not found"})})}),(0,X.jsx)(y.Z,{xs:12,className:"px-2 py-2 text-center",children:(0,X.jsx)(U.mW,{style:{width:120},onClick:_,children:"DONE"})})]})]})})})},le=O.Ry().shape({title:O.Z_().required("Field required"),body:O.Z_().required("Field required"),users:O.IX(O.Ry().shape({userId:O.Z_().required("Field required"),displayName:O.Z_().required("Field required"),email:O.Z_().required("Field required")})).min(1)}),ae={title:"",body:"",imageUrl:"",users:[]},oe=W.ZP.div(m||(m=(0,P.Z)(["\n    border-radius: 0.3rem;\n    border: 1px solid #ececec;\n    padding: 1.5rem 1rem;\n    margin-bottom: 1.2rem;\n"]))),de=W.ZP.div(x||(x=(0,P.Z)(["\n    position: relative;\n    .TrashBtn {\n        position: absolute;\n        top: 10px;\n        right: 10px;\n        height: 26px;\n        width: 26px;\n        border-radius: 26px;\n        padding: 0;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n"]))),ce=W.ZP.div(h||(h=(0,P.Z)(["\n    display: flex;\n    align-self: center;\n    justify-content: center;\n    margin-top: 1rem;\n"]))),ue=W.ZP.div(p||(p=(0,P.Z)(["\n    border: 1px solid #2d9a5c;\n    background-color: #91cdab;\n    padding: 0.5rem;\n    border-radius: 0.4rem;\n    margin-bottom: 1rem;\n"]))),me=W.ZP.div(f||(f=(0,P.Z)(["\n    border: 1px solid #da0000;\n    background-color: #ff5050;\n    padding: 0.5rem;\n    border-radius: 0.4rem;\n    margin-bottom: 1rem;\n"]))),xe=function(e){var n,i,r=e.onSubmit,t=(0,R.I0)(),s=(0,I.w5)(),l=(s.modalForm,s.reward_setModalForm,s.reward_adminGetList,(0,j.useState)(!1)),a=(0,F.Z)(l,2),o=a[0],d=a[1],c=(0,j.useState)(null),u=(0,F.Z)(c,2),m=u[0],x=u[1],h=(0,j.useState)(null),p=(0,F.Z)(h,2),f=p[0],Z=p[1],b=(0,I.zn)(),k=b.selectedUserRecipients,C=b.openModalUserRecipients,w=b.notifications_setOpenModalUserRecipients,S=(0,A.cI)({defaultValues:ae,resolver:(0,z.X)(le)}),P=S.control,O=S.reset,E=S.handleSubmit,T=S.setValue,W=S.getValues,Q=(S.watch,S.formState.errors),H=(0,A.Dq)({control:P,name:"users"}),K=H.fields,J=(H.insert,H.update,H.remove),Y=function(){var e=(0,g.Z)((0,v.Z)().mark((function e(n){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r(n);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),$=(0,j.useCallback)(function(){var e=(0,g.Z)((0,v.Z)().mark((function e(n){var i;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.prev=1,e.next=4,_.gv.upload(n);case 4:null!==(i=e.sent)&&void 0!==i&&i.data&&x(i.data),d(!1),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(1),x(null),console.log("e",e.t0),d(!1);case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(n){return e.apply(this,arguments)}}(),[m,f]);(0,j.useEffect)((function(){(null===k||void 0===k?void 0:k.length)>0?setTimeout((function(){T("users",k.map((function(e){return{userId:e.userId,displayName:e.displayName,email:e.email}})))}),350):(O(ae),x(null),Z(null))}),[k]),(0,j.useEffect)((function(){(null===k||void 0===k?void 0:k.length)>0||(O(ae),x(null),Z(null))}),[k]);var ee=(0,j.useCallback)((function(){t(w(!0))}),[C]),ie=(0,j.useCallback)((function(e){T("users",e.map((function(e){return{userId:e._id,displayName:e.displayName,email:e.email,imgPath:e.imgPath||null}})))}),[C]);return(0,X.jsxs)(j.Fragment,{children:[(0,X.jsx)(q.Z,{onSubmit:E(Y,(function(e){console.log("_errors",e)})),className:"px-2 FingoShapeRadius",children:(0,X.jsxs)(N.Z,{className:"justify-content-center",children:[(0,X.jsx)(y.Z,{xs:9,className:"px-2 mb-2",style:{display:"none"},children:(0,X.jsxs)("div",{className:"ModalRewardUploadContainer",children:[(0,X.jsx)("label",{htmlFor:"uploadImage",children:(0,X.jsxs)("div",{className:"UploadImageMarker",children:[(0,X.jsx)(L.r,{}),(0,X.jsx)("p",{className:"mb-0",children:"Browse to upload"})]})}),(0,X.jsx)("input",{id:"uploadImage",type:"file",onChange:function(e){var n;if(null!==(n=e.target.files)&&void 0!==n&&n[0]){var i=e.target.files[0],r=new FormData;r.append("photo",i),$(r)}}}),(0,X.jsxs)("div",{className:"ModalRewardUploadImg",children:[!m&&!f&&(0,X.jsx)("img",{src:V.Z.PlaceholderImg,alt:"placeholder"}),m?(0,X.jsx)("img",{src:m,alt:"img"}):(0,X.jsx)(X.Fragment,{children:f&&(0,X.jsx)("img",{src:f,alt:"img"})}),o&&(0,X.jsx)("div",{className:"ModalRewardUploadLoading",children:(0,X.jsx)(D.Z,{height:220})})]}),m&&(0,X.jsx)("div",{className:"mt-2 mb-3 text-center",children:(0,X.jsx)(U.mW,{onClick:function(){x(null)},size:"sm",color:"danger",children:"Remove Image"})})]})}),(0,X.jsx)(y.Z,{xs:12,className:"px-2",children:(0,X.jsxs)(oe,{children:[K.length>0&&(0,X.jsx)("div",{className:"text-center",children:(0,X.jsx)("p",{children:"Notification Recipients"})}),K.length>0?K.map((function(e,n){return(0,X.jsxs)(de,{children:[(0,X.jsx)(ne,{data:e,checked:!0,canChecked:!1}),(0,X.jsx)(M.Z,{variant:"danger",className:"TrashBtn",onClick:function(){return J(n)},children:(0,X.jsx)(G.r,{})})]},String(n))})):(0,X.jsx)("div",{className:"text-center",children:(0,X.jsx)("p",{children:"No Notification Recipients"})}),(0,X.jsxs)(N.Z,{children:[(null===Q||void 0===Q||null===(n=Q.users)||void 0===n?void 0:n.message)&&(0,X.jsx)(y.Z,{xs:12,className:"px-2 text-center",children:(0,X.jsx)(me,{children:(0,X.jsx)("p",{style:{marginBottom:0,color:"#fff"},children:String(null===Q||void 0===Q||null===(i=Q.users)||void 0===i?void 0:i.message)})})}),(0,X.jsx)(y.Z,{xs:12,className:"px-2 text-center",children:(0,X.jsx)(U.mW,{type:"button",onClick:ee,style:{width:220},children:"Add Recipients"})})]})]})}),(0,X.jsx)(y.Z,{xs:12,className:"px-2",children:(0,X.jsx)(ue,{children:(0,X.jsxs)("p",{style:{marginBottom:0,color:"#000"},children:["Use this template string to mention user"," ",(0,X.jsx)("strong",{children:"[[NAME]], [[EMAIL]]"})]})})}),(0,X.jsx)(y.Z,{xs:12,className:"px-2",children:(0,X.jsx)(A.Qr,{name:"title",control:P,render:function(e){var n,i,r,t,s=e.field;return(0,X.jsxs)(q.Z.Group,{className:"mb-3",controlId:"formGroupName",children:[(0,X.jsx)(q.Z.Label,{children:"Notification Title"}),(0,X.jsx)(U.O1,(0,B.Z)((0,B.Z)({},s),{},{as:"textarea",rows:2,placeholder:"Input title",isInvalid:Boolean(null===Q||void 0===Q||null===(n=Q.title)||void 0===n?void 0:n.message)})),(null===Q||void 0===Q||null===(i=Q.title)||void 0===i?void 0:i.message)&&(0,X.jsx)(q.Z.Control.Feedback,{type:"invalid",children:null!==(r=null===Q||void 0===Q||null===(t=Q.title)||void 0===t?void 0:t.message)&&void 0!==r?r:""})]})}})}),(0,X.jsx)(y.Z,{xs:12,className:"px-2",children:(0,X.jsx)(A.Qr,{name:"body",control:P,render:function(e){var n,i,r,t,s=e.field;return(0,X.jsxs)(q.Z.Group,{className:"mb-3",controlId:"formGroupName",children:[(0,X.jsx)(q.Z.Label,{children:"Notification Body"}),(0,X.jsx)(U.O1,(0,B.Z)((0,B.Z)({},s),{},{as:"textarea",rows:3,placeholder:"Notification Body",isInvalid:Boolean(null===Q||void 0===Q||null===(n=Q.body)||void 0===n?void 0:n.message)})),(null===Q||void 0===Q||null===(i=Q.body)||void 0===i?void 0:i.message)&&(0,X.jsx)(q.Z.Control.Feedback,{type:"invalid",children:null!==(r=null===Q||void 0===Q||null===(t=Q.body)||void 0===t?void 0:t.message)&&void 0!==r?r:""})]})}})}),(0,X.jsx)(y.Z,{xs:12,className:"px-2",children:(0,X.jsx)(ce,{children:(0,X.jsx)(U.mW,{type:"submit",onClick:E,children:"SEND NOTIFICATION"})})})]})}),(0,X.jsx)(se,{defaultValues:W("users"),onSubmit:ie})]})},he=function(){var e=(0,R.I0)(),n=(0,I.zn)().notifications_getNotificationRecipients,i=(0,I.aC)(),r=i.user,t=i.isAuthenticated,s=(0,Z.s0)();(0,j.useEffect)((function(){var i;t&&"admin"===(null===r||void 0===r?void 0:r.role)?e(n(i)):s("/accessdenied")}),[r,t]);var l=(0,j.useCallback)(function(){var e=(0,g.Z)((0,v.Z)().mark((function e(n){var i,r,t;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("----",n),e.prev=1,r=(null===n||void 0===n||null===(i=n.users)||void 0===i?void 0:i.map((function(e){return{userId:e.userId,displayName:e.displayName,email:e.email}})))||[],t={title:n.title,body:n.body,imageUrl:null,users:r},e.next=6,_.ho.admin_sendGeneralNotifications(t);case 6:e.sent&&T().fire({title:"Success",text:"Notification send successfully!",icon:"success",showCancelButton:!1,confirmButtonColor:"#009c4e",confirmButtonText:"Ok"}).then((function(e){e.isConfirmed})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),T().fire({title:"Opss..",text:"Failed to send notifications!",icon:"error",showCancelButton:!1,confirmButtonColor:"#9c0017",confirmButtonText:"Ok"}).then((function(e){e.isConfirmed}));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(n){return e.apply(this,arguments)}}(),[]);return(0,X.jsxs)(C.v,{children:[(0,X.jsx)(k.q,{children:(0,X.jsx)("title",{children:"Notifications"})}),(0,X.jsx)(b.Z,{fluid:!0,children:(0,X.jsx)("div",{className:"row justify-center h-auto",children:(0,X.jsx)("div",{className:"col-12 col-md-10 col-lg-8",children:(0,X.jsx)(N.Z,{className:"justify-content-md-center",children:(0,X.jsx)(y.Z,{children:(0,X.jsxs)("div",{className:"AdminRewardContainer",children:[(0,X.jsxs)("div",{className:"AdminRewardHeader mb-4",children:[(0,X.jsx)("button",{className:"back-arrow",onClick:function(){s("/home")},children:(0,X.jsx)(S.r,{})}),(0,X.jsx)("div",{children:(0,X.jsx)("h2",{className:"mb-3, text-center",children:"Notifications"})})]}),(0,X.jsx)(xe,{onSubmit:l}),(0,X.jsx)(w.e,{})]})})})})})})]})}}}]);
//# sourceMappingURL=845.be626d7b.chunk.js.map